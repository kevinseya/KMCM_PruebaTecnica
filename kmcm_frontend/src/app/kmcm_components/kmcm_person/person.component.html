<app-navbar></app-navbar>
<div *ngIf="persons.length > 0">
  <h2 class="table-title">Lista de Personas</h2>
  <div class="button-container" style="text-align: center;">
    <button class="btn-submit" (click)="openCreateModal()">Crear Nueva Persona</button>
  </div>
  <table class="person-table">
    <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Apellido</th>
      <th>Dirección</th>
      <th>Teléfono</th>
      <th>Fecha de Nacimiento</th>
      <th>Acciones</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let person of persons">
      <td>{{ person.kmcm_id }}</td>
      <td>{{ person.kmcm_name }}</td>
      <td>{{ person.kmcm_lastname }}</td>
      <td>{{ person.kmcm_address }}</td>
      <td>{{ person.kmcm_phone }}</td>
      <td>{{ person.kmcm_birthdate | date: 'shortDate' }}</td>
      <td>
        <button class="btn-edit" (click)="openEditModal(person)">Editar</button>
        <button class="btn-delete" (click)="deletePerson(person.kmcm_id)"  [disabled]="person.kmcm_id === null">Eliminar</button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<div *ngIf="persons.length === 0">
  <p>No hay personas disponibles.</p>
</div>

<!-- Modal para editar o crear persona -->
<div class="modal" *ngIf="selectedPerson">
  <div class="modal-content">
    <span class="close" (click)="closeEditModal()">&times;</span>
    <h2>{{ selectedPerson.kmcm_id ? 'Editar Persona' : 'Crear Nueva Persona' }}</h2>
    <form (ngSubmit)="savePerson()">
      <div class="form-group">
        <label for="name">Nombre:</label>
        <input id="name" [(ngModel)]="selectedPerson.kmcm_name" name="name" required />
      </div>
      <div class="form-group">
        <label for="lastname">Apellido:</label>
        <input id="lastname" [(ngModel)]="selectedPerson.kmcm_lastname" name="lastname" required />
      </div>
      <div class="form-group">
        <label for="address">Dirección:</label>
        <input id="address" [(ngModel)]="selectedPerson.kmcm_address" name="address" required />
      </div>
      <div class="form-group">
        <label for="phone">Teléfono:</label>
        <input id="phone" [(ngModel)]="selectedPerson.kmcm_phone" name="phone" required />
      </div>
      <div class="form-group">
        <label for="birthdate">Fecha de Nacimiento:</label>
        <input id="birthdate" [(ngModel)]="selectedPerson.kmcm_birthdate" name="birthdate" type="date" required />
      </div>
      <button class="btn-submit" type="submit">Guardar Cambios</button>
    </form>
  </div>
</div>
